package com.address;

import java.sql.SQLException;
import java.util.List;


public class AddressBookDao implements AddressBookInterface {
	java.sql.Connection          con   = null; 
	java.sql.PreparedStatement   pstmt = null;
	java.sql.ResultSet           rs    = null;
	com.util.DBConnectionMgr     dbMgr = null;
	
	@Override
	public AddressVO getAddressDetail(AddressVO paVO) {
		System.out.println("DAO getAddressDetail 호출성공");
		return null;
	}

	@Override
	public AddressVO addressInsert(AddressVO paVO) {
		System.out.println("DAO addressInsert 호출성공");
		AddressVO raVO = null;
		raVO = new AddressVO();
		dbMgr=com.util.DBConnectionMgr.getInstance();
		// +연산자를 써도 String 객체가 새로 생성되지 않음
		StringBuilder sql = new StringBuilder();
		int status = 0; // 0이면 입력 실패, 1이면 입력성공
		try {
			sql.append("INSERT INTO mkaddrtb VALUES('haha','이성계','서울시 금천구 가산동'    ");
			sql.append("		                  ,'01055559999','1','2000-10-29','고교통창'");
			sql.append("		                   ,TO_CHAR(sysdate,'YYYY-MM-DD'))      ");
			// db의 정보를 보내는 통로
			con = dbMgr.getConnection();
			// sql문을 전송
			pstmt = con.prepareStatement(sql.toString());
			// DML 구문의 UPDATE, DELETE, INSERT문 리턴받기
			status = pstmt.executeUpdate();
			System.out.println(status);
			raVO.setStatus(status); //AddressVO status변수에 1저장
		} catch (SQLException se) { //ORA-XXXX
			System.out.println(se.toString()); //sql 에러문을 보여줌
			System.out.println(sql.toString()); // sql문을 보여줌
		} catch (Exception e){
			System.out.println(e.toString());
		} finally { // 에러가 나던 말던 무조건 닫아줘라
			dbMgr.freeConnection(con, pstmt);
		}
		return raVO;
	}

	@Override
	public AddressVO addressUpdate(AddressVO paVO) {
		System.out.println("DAO addressUpdate 호출성공");
		return null;
	}

	@Override
	public AddressVO addressDelete(AddressVO paVO) {
		System.out.println("DAO addressDelete 호출성공");
		return null;
	}

	@Override
	public List<AddressVO> getAddress() {
		System.out.println("DAO getAddress 호출성공");
		StringBuilder sql = new StringBuilder();
		sql.append("SELECT id, name, address, gender, hp ");
	    sql.append("      ,birthday, comments, regdate   ");
	    sql.append("  FROM mkaddrtb                      ");
		return null;
	}
//	public static void main(String args[]) {
//		new AddressBookDao().addressInsert(null);
//	}

}
