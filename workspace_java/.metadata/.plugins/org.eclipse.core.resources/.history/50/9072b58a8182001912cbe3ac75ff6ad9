package com.oracle;

import java.sql.CallableStatement;
import java.sql.Connection;
import java.util.Scanner;

import com.util.DBConnectionMgr;

public class EmpJDBC {
	Connection 		   con = null;//연결통로확보
	CallableStatement cstmt =null;//프로시저를 호출,요청
	public void getProc_deptnoUpdate() {
		String msg = null;//프로시저의 out속성값 받아서 저장할 변수
		//DBConnectionMgr dbMgr = new DBConnectionMgr과 밑 행의 차이를 확실히 아는가?
		DBConnectionMgr dbMgr = DBConnectionMgr.getInstance();
		try {
			con = dbMgr.getConnection();
			cstmt = con.prepareCall("{call proc_deptnoUpdate(?,?)}");
			System.out.println("부서번호를 입력하세요.");
			Scanner scan = new Scanner(System.in);
			int u_deptno = scan.nextInt();//사용자가 입력한 부서번호 받아오기
			cstmt.setInt(1, u_deptno);//1번째 물음표(IN속성 넣어주기)
			cstmt.registerOutParameter(2, java.sql.Types.VARCHAR);//2번째 물음표(OUT속성 타입정해주기)
			//오라클서버에게 처리요청
			int result = cstmt.executeUpdate(); //성공=1, 실패=0
//			con.commit();//자바에서 오라클의 커밋을 대신 처리해주는 코드
			msg = cstmt.getString(2);//2번째 msg 꺼내오기
//			System.out.println(msg);
		} catch (Exception e) {
			System.out.println(e.getMessage());//e.getMessage() 오라클의 에러메세지를 그대로 보여줌
		}
	}
	public String getProc_empnoUpdate() {
		String msg = null;
		//DBConnectionMgr dbMgr = new DBConnectionMgr과 밑 행의 차이를 확실히 아는가?
		DBConnectionMgr dbMgr = DBConnectionMgr.getInstance();
		try {
			con = dbMgr.getConnection();
			cstmt = con.prepareCall("{call proc_empnoUpdate(?,?)}");
			System.out.println("사원번호를 입력하세요.");
			Scanner scan = new Scanner(System.in);
			int u_empno = scan.nextInt();//사용자가 입력한 사원번호 받아오기
			cstmt.setInt(1, u_empno);//1번째 물음표(IN속성 넣어주기)
			cstmt.registerOutParameter(2, java.sql.Types.VARCHAR);//2번째 물음표(OUT속성 타입정해주기)
			//오라클서버에게 처리요청
			int result = cstmt.executeUpdate(); //성공=1, 실패=0
//			con.commit();//자바에서 오라클의 커밋을 대신 처리해주는 코드
			msg = cstmt.getString(2);//2번째 msg 꺼내오기
			System.out.println(msg);
		} catch (Exception e) {
			System.out.println(e.getMessage());//e.getMessage() 오라클의 에러메세지를 그대로 보여줌
		}
		return msg;
	}
	public static void main(String[] args) {
		EmpJDBC ejdbc = new EmpJDBC();
		ejdbc.getProc_empnoUpdate();

	}

}
