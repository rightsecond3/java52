<html>

<head>
    <meta charset="UTF-8">
    <title>Break Neck Pizza Delivery</title>
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <script type="text/javascript">
        function orderPizza() {
            $("#f_pizza").submit(); //form 태그전송
        }
        function getCustomerInfo() {
            //alert(user_tel);
            //태그의 아이디인 mem_tel을 사용하여 val()메소드를 호출하면 사용자가 입력한 값을 읽어올 수 있다.
            var user_tel = $("#mem_tel").val();
            /*
            jQuery API를 사용하면 비동기 통신 객체를 생성하지 않고
            바로 요청 처리 할 수 있어서 코딩의 양도 줄고 메소드 한개로 처리 가능
            */
            $.ajax({
                method : "get"
                , url : "./customerInfo.jsp?mem_tel="
                ,success : function(data) {
                    var jsonDoc = JSON.parse(data);
                    if(jsonDoc.length>0) {
                        var temp = "";
                        for(var i=0;i<jsonDoc.length;i++) {
                            //alert(jsonDoc[i].mem_addr);
                            if(user_tel==jsonDoc[i].mem_tel) {
                                temp+=jsonDoc[i].mem_addr;
                            }
                        }
                    }
                    $("#mem_addr").text(temp);
                }
            });
        }
    </script>
</head>

<body>
    <form id="f_pizza" action="orderConfirm.jsp" method="GET">
    <!-- hidden 화면으로는 보이지 않지만 서버로 보낼 때 쓰는 타입(ajax처리X) -->
    <input type="hidden" id="mem_name" name="mem_name" value="홍길동">
    <p><img src="breakneck-logo.gif" alt="Break Neck Pizza" /></p>
    <p>Enter your phone number:
        <input type="text" size="14" id="mem_tel" name="mem_tel" onChange="getCustomerInfo();" />
    </p>
    <p>Type your order in here:</p>
    <p><textarea name="paper" id="paper" rows="6" cols="50"></textarea></p>
    <p>Your order will be delivered to:</p>
    <!-- 
        JSON포맷의 이름과 태그의 name속성과 id속성을 같은 값으로 통일함.
        name속성 : jsp에서 사용자가 입력한 값을 읽을 때 사용
        id 속성 : javascript에서 사용자가 입력한 값을 읽을 때 사용
        name과 id속성은 같은 값을 사용함.
        오라클 서버에 테이블 컬럼명과 VO패턴의 멤버변수 이름, Map의 key는 모두 통일해서 사용
    -->
    <p><textarea name="mem_addr" id="mem_addr" rows="4" cols="50"></textarea></p>
    <p><input type="button" id="btn_order" onclick="orderPizza()" value="Order Pizza" /></p>
    <div id="d_msg"></div>
    </form>
</body>

</html>